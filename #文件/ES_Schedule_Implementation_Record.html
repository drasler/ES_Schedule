<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ES_Schedule æ ¸å¿ƒæ¶æ§‹å¯¦è¸æ›¸</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <style>
        :root {
            --primary: #2563eb;
            --primary-dark: #1d4ed8;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --info: #06b6d4;
            --gray-50: #f9fafb;
            --gray-100: #f3f4f6;
            --gray-200: #e5e7eb;
            --gray-600: #4b5563;
            --gray-700: #374151;
            --gray-800: #1f2937;
            --gray-900: #111827;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Segoe UI', 'Microsoft JhengHei', sans-serif;
            background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%);
            min-height: 100vh;
            padding: 2rem;
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.97);
            border-radius: 20px;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            padding: 3rem;
        }

        header {
            text-align: center;
            margin-bottom: 3rem;
            padding-bottom: 2rem;
            border-bottom: 3px solid var(--primary);
        }

        header h1 {
            font-size: 2.2rem;
            background: linear-gradient(135deg, #2563eb 0%, #1d4ed8 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .status-badge {
            display: inline-block;
            padding: 0.5rem 1.5rem;
            background: var(--success);
            color: white;
            border-radius: 20px;
            font-weight: 600;
            margin-top: 1rem;
        }

        .meta-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
            padding: 1.5rem;
            background: var(--gray-50);
            border-radius: 12px;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .meta-item .label {
            font-weight: 600;
            color: var(--gray-700);
        }

        .meta-item .value {
            color: var(--primary);
        }

        section {
            margin-bottom: 2.5rem;
        }

        section h2 {
            font-size: 1.5rem;
            color: var(--gray-800);
            margin-bottom: 1rem;
            padding-left: 1rem;
            border-left: 4px solid var(--primary);
        }

        section h3 {
            font-size: 1.2rem;
            color: var(--gray-700);
            margin: 1.5rem 0 1rem;
        }

        .card {
            background: white;
            border: 1px solid var(--gray-200);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        .alert {
            padding: 1rem 1.5rem;
            border-radius: 8px;
            margin: 1rem 0;
            display: flex;
            align-items: flex-start;
            gap: 0.75rem;
        }

        .alert-success {
            background: #d1fae5;
            border: 1px solid #10b981;
            color: #065f46;
        }

        .alert-info {
            background: #dbeafe;
            border: 1px solid #3b82f6;
            color: #1e40af;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
        }

        th,
        td {
            padding: 0.75rem 1rem;
            text-align: left;
            border-bottom: 1px solid var(--gray-200);
        }

        th {
            background: var(--gray-50);
            font-weight: 600;
            color: var(--gray-700);
        }

        .status-done {
            color: var(--success);
            font-weight: 600;
        }

        code {
            background: var(--gray-100);
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
            font-family: 'Consolas', monospace;
            color: var(--primary-dark);
            font-size: 0.9rem;
        }

        pre {
            background: var(--gray-900);
            color: #e5e7eb;
            padding: 1.5rem;
            border-radius: 8px;
            overflow-x: auto;
            margin: 1rem 0;
            font-size: 0.85rem;
        }

        pre code {
            background: none;
            color: inherit;
            padding: 0;
        }

        .mermaid {
            background: white;
            padding: 1rem;
            border-radius: 8px;
            margin: 1rem 0;
            text-align: center;
        }

        .file-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1rem;
        }

        .file-card {
            background: var(--gray-50);
            border-radius: 8px;
            padding: 1rem;
            border-left: 4px solid var(--primary);
        }

        .file-card h4 {
            color: var(--gray-800);
            margin-bottom: 0.5rem;
            font-size: 0.95rem;
        }

        .file-card p {
            color: var(--gray-600);
            font-size: 0.85rem;
        }

        .log-preview {
            background: #1e1e1e;
            color: #9cdcfe;
            padding: 1rem;
            border-radius: 8px;
            font-family: 'Consolas', monospace;
            font-size: 0.8rem;
            line-height: 1.8;
            overflow-x: auto;
        }

        .log-preview .timestamp {
            color: #ce9178;
        }

        .log-preview .level {
            color: #4ec9b0;
        }

        .log-preview .thread {
            color: #608b4e;
        }

        footer {
            text-align: center;
            padding-top: 2rem;
            border-top: 1px solid var(--gray-200);
            color: var(--gray-600);
        }
    </style>
</head>

<body>
    <div class="container">
        <header>
            <h1>ğŸ“˜ ES_Schedule æ ¸å¿ƒæ¶æ§‹å¯¦è¸æ›¸</h1>
            <p style="color: #4b5563;">å¯æ“´å±•å¼å¤šæ’ç¨‹ä»»å‹™æ¶æ§‹ - å¯¦ä½œè¨˜éŒ„æ–‡ä»¶</p>
            <span class="status-badge">âœ… å¯¦ä½œå®Œæˆ</span>
        </header>

        <div class="meta-info">
            <div class="meta-item">
                <span class="label">ğŸ“… å¯¦ä½œæ—¥æœŸ:</span>
                <span class="value">2026-01-15</span>
            </div>
            <div class="meta-item">
                <span class="label">ğŸ“¦ å°ˆæ¡ˆåç¨±:</span>
                <span class="value">ES_Schedule</span>
            </div>
            <div class="meta-item">
                <span class="label">ğŸ”§ ç›®æ¨™æ¡†æ¶:</span>
                <span class="value">.NET Framework 4.8</span>
            </div>
            <div class="meta-item">
                <span class="label">ğŸ“Š ç·¨è­¯ç‹€æ…‹:</span>
                <span class="value" style="color: #10b981;">æˆåŠŸ (0 éŒ¯èª¤)</span>
            </div>
        </div>

        <!-- å¯¦ä½œæ‘˜è¦ -->
        <section>
            <h2>ğŸ“‹ å¯¦ä½œæ‘˜è¦</h2>
            <div class="card">
                <p>æœ¬å°ˆæ¡ˆå»ºç«‹äº†ä¸€å€‹å¯æ“´å±•çš„æ’ç¨‹ä»»å‹™ç³»çµ±ï¼Œæ”¯æ´é€é Windows å·¥ä½œæ’ç¨‹å™¨åŸ·è¡Œä¸åŒçš„æ’ç¨‹ä»»å‹™ã€‚æ¡ç”¨å·¥å» æ¨¡å¼è¨­è¨ˆï¼Œåªéœ€åœ¨ <code>JobFactory</code>
                    ä¸­è¨»å†Šæ–°ä»»å‹™ï¼Œå³å¯é€éå‘½ä»¤åˆ—å¼•æ•¸åŸ·è¡Œã€‚</p>

                <div class="alert alert-success">
                    <span>âœ…</span>
                    <div>
                        <strong>æ ¸å¿ƒç‰¹é»ï¼š</strong>
                        <ul>
                            <li>ç„¡ Console è¼¸å‡º - æ‰€æœ‰è¨Šæ¯å¯«å…¥ Log æª”æ¡ˆ</li>
                            <li>Exit Code æ©Ÿåˆ¶ - 0=æˆåŠŸ, 1=åƒæ•¸éŒ¯èª¤, 2=é…ç½®éŒ¯èª¤, 3=åŸ·è¡Œä¾‹å¤–</li>
                            <li>Singleton Logger - Thread-Safe æ—¥èªŒæœå‹™</li>
                            <li>å·¥å» æ¨¡å¼ - æ˜“æ–¼æ“´å±•æ–°ä»»å‹™</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <!-- å·²å®Œæˆæª”æ¡ˆæ¸…å–® -->
        <section>
            <h2>ğŸ“ å·²å®Œæˆæª”æ¡ˆæ¸…å–®</h2>

            <div class="file-grid">
                <div class="file-card">
                    <h4>ğŸ“„ Program.cs</h4>
                    <p>ä¸»ç¨‹å¼é€²å…¥é»ï¼Œå¯¦ä½œ Exit Code æ©Ÿåˆ¶ï¼Œç„¡ Console è¼¸å‡º</p>
                </div>
                <div class="file-card">
                    <h4>ğŸ“„ Common/Logger.cs</h4>
                    <p>æ—¥èªŒæœå‹™é¡åˆ¥ï¼ŒSingletonã€Thread-Safeã€å¤šç´šåˆ¥æ—¥èªŒ</p>
                </div>
                <div class="file-card">
                    <h4>ğŸ“„ Config/AppConfigService.cs</h4>
                    <p>é…ç½®æœå‹™ï¼Œè¼‰å…¥é€£ç·šå­—ä¸²ã€æ‡‰ç”¨ç¨‹å¼è¨­å®š</p>
                </div>
                <div class="file-card">
                    <h4>ğŸ“„ Config/TransferConfig.cs</h4>
                    <p>è½‰ç§»é…ç½®æ¨¡å‹ï¼Œå®šç¾©è³‡æ–™è½‰ç§»ä»»å‹™çµæ§‹</p>
                </div>
                <div class="file-card">
                    <h4>ğŸ“„ Interfaces/IScheduleJob.cs</h4>
                    <p>æ’ç¨‹ä»»å‹™ä»‹é¢ï¼Œæ‰€æœ‰ä»»å‹™å¿…é ˆå¯¦ä½œ</p>
                </div>
                <div class="file-card">
                    <h4>ğŸ“„ Services/JobFactory.cs</h4>
                    <p>ä»»å‹™å·¥å» ï¼Œè² è²¬å»ºç«‹èˆ‡ç®¡ç†æ’ç¨‹ä»»å‹™</p>
                </div>
                <div class="file-card">
                    <h4>ğŸ“„ Jobs/RepairRecordsTransferJob.cs</h4>
                    <p>ç¶­ä¿®è¨˜éŒ„è½‰ç§»ä»»å‹™å¯¦ä½œ</p>
                </div>
                <div class="file-card">
                    <h4>ğŸ“„ Services/ActualTimeCalcService.cs</h4>
                    <p>å·¥æ™‚è¨ˆç®—æœå‹™ï¼Œå¯¦ä½œè³‡æ–™è®€å–èˆ‡å¯«å…¥é‚è¼¯</p>
                </div>
                <div class="file-card">
                    <h4>ğŸ“„ Jobs/ActualTimeCalcJob.cs</h4>
                    <p>å·¥æ™‚è¨ˆç®—æ’ç¨‹ä»»å‹™å¯¦ä½œï¼Œæ•´åˆæœå‹™èˆ‡åƒæ•¸</p>
                </div>
                <div class="file-card">
                    <h4>ğŸ“„ Models/*.cs</h4>
                    <p>ActualTime, ActualTimeDetail, TimesheetRecord è³‡æ–™æ¨¡å‹</p>
                </div>
            </div>
        </section>

        <!-- å°ˆæ¡ˆæ¶æ§‹åœ– -->
        <section>
            <h2>ğŸ—ï¸ å°ˆæ¡ˆæ¶æ§‹åœ–</h2>
            <div class="card">
                <pre class="mermaid">
graph TB
    subgraph Entry["ç¨‹å¼é€²å…¥é»"]
        A[Program.cs]
    end
    
    subgraph Core["æ ¸å¿ƒæœå‹™"]
        B[Logger.cs]
        C[AppConfigService.cs]
    end
    
    subgraph Factory["å·¥å» æ¨¡å¼"]
        D[JobFactory.cs]
    end
    
    subgraph Interface["ä»‹é¢å®šç¾©"]
        E["IScheduleJob"]
    end
    
    subgraph Jobs["æ’ç¨‹ä»»å‹™"]
        F[RepairRecordsTransferJob]
        G[ActualTimeCalcJob]
        H["å…¶ä»–ä»»å‹™..."]
    end
    
    subgraph Services["æ¥­å‹™é‚è¼¯"]
        S1[ActualTimeCalcService]
    end

    subgraph Config["é…ç½®"]
        I[App.config]
        J[TransferConfigs.json]
    end
    
    A --> D
    A --> B
    D --> E
    E --> F
    E --> G
    E --> H
    F --> C
    G --> S1
    S1 --> C
    C --> I
    C --> J
    
    style A fill:#2563eb,color:#fff
    style D fill:#059669,color:#fff
    style E fill:#f59e0b,color:#fff
    style G fill:#059669,color:#fff
                </pre>
            </div>
        </section>

        <!-- Exit Code æ©Ÿåˆ¶ -->
        <section>
            <h2>ğŸ”¢ Exit Code æ©Ÿåˆ¶</h2>
            <div class="card">
                <table>
                    <thead>
                        <tr>
                            <th>Exit Code</th>
                            <th>æ„ç¾©</th>
                            <th>è§¸ç™¼æƒ…å¢ƒ</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>0</code></td>
                            <td class="status-done">æˆåŠŸåŸ·è¡Œ</td>
                            <td>ä»»å‹™æ­£å¸¸å®Œæˆ</td>
                        </tr>
                        <tr>
                            <td><code>1</code></td>
                            <td>åƒæ•¸éŒ¯èª¤</td>
                            <td>ç„¡å¼•æ•¸ã€æ‰¾ä¸åˆ°æŒ‡å®šä»»å‹™</td>
                        </tr>
                        <tr>
                            <td><code>2</code></td>
                            <td>é…ç½®éŒ¯èª¤</td>
                            <td>é€£ç·šå­—ä¸²ç¼ºå¤±ã€é…ç½®æª”ç„¡æ•ˆ</td>
                        </tr>
                        <tr>
                            <td><code>3</code></td>
                            <td>åŸ·è¡Œä¾‹å¤–</td>
                            <td>æœªè™•ç†çš„ä¾‹å¤– (å¦‚è³‡æ–™åº«é€£ç·šå¤±æ•—)</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Log è¼¸å‡ºç¯„ä¾‹ -->
        <section>
            <h2>ğŸ“ Log è¼¸å‡ºç¯„ä¾‹</h2>
            <div class="card">
                <h3>åŸ·è¡Œ ActualTimeCalc ä»»å‹™</h3>
                <div class="log-preview">
                    <span class="timestamp">[2026-01-15 16:44:30.878]</span> <span class="level">[Info ]</span> <span
                        class="thread">[Thread-1]</span> é–‹å§‹åŸ·è¡Œæ’ç¨‹ä»»å‹™: ActualTimeCalc
                    <span class="timestamp">[2026-01-15 16:44:30.879]</span> <span class="level">[Info ]</span> <span
                        class="thread">[Thread-1]</span> é–‹å§‹è¨ˆç®—å·¥æ™‚è³‡æ–™ï¼Œè¨ˆç®—æ—¥æœŸ: 2026-01-12
                    <span class="timestamp">[2026-01-15 16:44:31.369]</span> <span class="level">[Info ]</span> <span
                        class="thread">[Thread-1]</span> å¾ AMES_DB è®€å–åˆ° 726 ç­†å·¥æ™‚è³‡æ–™
                    <span class="timestamp">[2026-01-15 16:44:31.809]</span> <span class="level">[Info ]</span> <span
                        class="thread">[Thread-1]</span> è¨ˆç®— 0020 å·¥å–®: 105248301A01 å·¥æ™‚: 351.00 å®Œæˆæ•¸: 0
                    <span class="timestamp">[2026-01-15 16:44:34.868]</span> <span class="level">[Info ]</span> <span
                        class="thread">[Thread-1]</span> SAP ä¸Šå‚³æª”æ¡ˆå·²ç”¢ç”Ÿ: .../SFIS_WorkTime_20260115164434.txt
                    <span class="timestamp">[2026-01-15 16:44:34.868]</span> <span class="level">[Info ]</span> <span
                        class="thread">[Thread-1]</span> ä»»å‹™åŸ·è¡Œå®Œæˆï¼ŒExit Code: 0
                </div>
            </div>
        </section>

        <!-- é©—è­‰çµæœ -->
        <section>
            <h2>âœ… é©—è­‰çµæœ</h2>
            <div class="card">
                <table>
                    <thead>
                        <tr>
                            <th>æ¸¬è©¦é …ç›®</th>
                            <th>æ¸¬è©¦å¼•æ•¸</th>
                            <th>é æœŸçµæœ</th>
                            <th>å¯¦éš›çµæœ</th>
                            <th>ç‹€æ…‹</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>ç·¨è­¯å°ˆæ¡ˆ</td>
                            <td>-</td>
                            <td>0 éŒ¯èª¤, 0 è­¦å‘Š</td>
                            <td>0 éŒ¯èª¤, 0 è­¦å‘Š</td>
                            <td class="status-done">âœ… é€šé</td>
                        </tr>
                        <tr>
                            <td>ç„¡å¼•æ•¸åŸ·è¡Œ</td>
                            <td><code>(ç„¡)</code></td>
                            <td>Exit Code 1</td>
                            <td>Exit Code 1</td>
                            <td class="status-done">âœ… é€šé</td>
                        </tr>
                        <tr>
                            <td>åŸ·è¡Œè½‰ç§»ä»»å‹™</td>
                            <td><code>RepairRecordsTransfer</code></td>
                            <td>Exit Code 0/3</td>
                            <td>Exit Code 0</td>
                            <td class="status-done">âœ… é€šé (å·²æ¨¡æ“¬)</td>
                        </tr>
                        <tr>
                            <td>åŸ·è¡Œå·¥æ™‚è¨ˆç®—</td>
                            <td><code>ActualTimeCalc</code></td>
                            <td>Exit Code 0</td>
                            <td>Exit Code 0</td>
                            <td class="status-done">âœ… é€šé (é€£ç·šæˆåŠŸ)</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- ä½¿ç”¨æ–¹å¼ -->
        <section>
            <h2>ğŸš€ ä½¿ç”¨æ–¹å¼</h2>

            <div class="card">
                <h3>Windows å·¥ä½œæ’ç¨‹å™¨è¨­å®š</h3>
                <table>
                    <thead>
                        <tr>
                            <th>æ¬„ä½</th>
                            <th>è¨­å®šå€¼</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>ç¨‹å¼æˆ–æŒ‡ä»¤ç¢¼</td>
                            <td><code>D:\Path\To\ES_Schedule.exe</code></td>
                        </tr>
                        <tr>
                            <td>æ–°å¢å¼•æ•¸</td>
                            <td><code>ActualTimeCalc</code> (æˆ–å…¶ä»–ä»»å‹™åç¨±)</td>
                        </tr>
                        <tr>
                            <td>é–‹å§‹ä½ç½®</td>
                            <td><code>D:\Path\To\</code></td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="card">
                <h3>æ–°å¢ä»»å‹™æ­¥é©Ÿ</h3>
                <ol>
                    <li>åœ¨ <code>Jobs/</code> ç›®éŒ„å»ºç«‹æ–°é¡åˆ¥ï¼Œå¯¦ä½œ <code>IScheduleJob</code> ä»‹é¢</li>
                    <li>åœ¨ <code>JobFactory._jobs</code> å­—å…¸ä¸­è¨»å†Šæ–°ä»»å‹™</li>
                    <li>é‡æ–°ç·¨è­¯å°ˆæ¡ˆ</li>
                    <li>ä½¿ç”¨ä»»å‹™åç¨±ä½œç‚ºå‘½ä»¤åˆ—å¼•æ•¸åŸ·è¡Œ</li>
                </ol>
            </div>
        </section>

        <!-- ä¸‹ä¸€æ­¥ -->
        <section>
            <h2>ğŸ“Œ ä¸‹ä¸€æ­¥</h2>
            <div class="alert alert-info">
                <span>ğŸ’¡</span>
                <div>
                    <strong>ç¶­è­·å»ºè­°ï¼š</strong>
                    <ul>
                        <li>å®šæœŸå‚™ä»½ Logs è³‡æ–™å¤¾</li>
                        <li>ç›£æ§ Windows æ’ç¨‹å™¨çš„åŸ·è¡Œçµæœä»£ç¢¼</li>
                        <li>æ›´æ–° App.config é€£ç·šå­—ä¸² (æ­£å¼ç’°å¢ƒ)</li>
                    </ul>
                </div>
            </div>
        </section>

        <footer>
            <p>ğŸ“˜ ES_Schedule Implementation Record v2 | æ›´æ–°æ—¥æœŸ: 2026-01-15</p>
        </footer>
    </div>

    <script>
        mermaid.initialize({ startOnLoad: true, theme: 'default' });
    </script>
</body>

</html>