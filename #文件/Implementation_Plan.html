<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ES_Schedule æ’ç¨‹ç³»çµ±å¯¦ä½œè¦åŠƒæ›¸</title>
    <!-- Vue.js 3 CDN (ä¾ Customization Rules è¦ç¯„) -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <!-- SweetAlert2 CDN (ä¾ Customization Rules è¦ç¯„) -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <!-- Mermaid.js for Diagrams -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <style>
        :root {
            --primary: #2563eb;
            --primary-dark: #1d4ed8;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --gray-50: #f9fafb;
            --gray-100: #f3f4f6;
            --gray-200: #e5e7eb;
            --gray-600: #4b5563;
            --gray-700: #374151;
            --gray-800: #1f2937;
            --gray-900: #111827;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Segoe UI', 'Microsoft JhengHei', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 2rem;
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.97);
            border-radius: 20px;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            padding: 3rem;
        }

        header {
            text-align: center;
            margin-bottom: 3rem;
            padding-bottom: 2rem;
            border-bottom: 3px solid var(--primary);
        }

        header h1 {
            font-size: 2.5rem;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        header .subtitle {
            color: var(--gray-600);
            font-size: 1.1rem;
        }

        .meta-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
            padding: 1.5rem;
            background: var(--gray-50);
            border-radius: 12px;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .meta-item .label {
            font-weight: 600;
            color: var(--gray-700);
        }

        .meta-item .value {
            color: var(--primary);
        }

        section {
            margin-bottom: 2.5rem;
        }

        section h2 {
            font-size: 1.5rem;
            color: var(--gray-800);
            margin-bottom: 1rem;
            padding-left: 1rem;
            border-left: 4px solid var(--primary);
        }

        section h3 {
            font-size: 1.2rem;
            color: var(--gray-700);
            margin: 1.5rem 0 1rem;
        }

        .card {
            background: white;
            border: 1px solid var(--gray-200);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        .alert {
            padding: 1rem 1.5rem;
            border-radius: 8px;
            margin: 1rem 0;
            display: flex;
            align-items: flex-start;
            gap: 0.75rem;
        }

        .alert-warning {
            background: #fef3c7;
            border: 1px solid #f59e0b;
            color: #92400e;
        }

        .alert-info {
            background: #dbeafe;
            border: 1px solid #3b82f6;
            color: #1e40af;
        }

        .alert-success {
            background: #d1fae5;
            border: 1px solid #10b981;
            color: #065f46;
        }

        .alert-danger {
            background: #fee2e2;
            border: 1px solid #ef4444;
            color: #991b1b;
        }

        ul,
        ol {
            padding-left: 1.5rem;
            margin: 0.5rem 0;
        }

        li {
            margin: 0.5rem 0;
            color: var(--gray-700);
        }

        code {
            background: var(--gray-100);
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
            font-family: 'Consolas', 'Monaco', monospace;
            color: var(--primary-dark);
        }

        pre {
            background: var(--gray-900);
            color: #e5e7eb;
            padding: 1.5rem;
            border-radius: 8px;
            overflow-x: auto;
            margin: 1rem 0;
        }

        pre code {
            background: none;
            color: inherit;
            padding: 0;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
        }

        th,
        td {
            padding: 0.75rem 1rem;
            text-align: left;
            border-bottom: 1px solid var(--gray-200);
        }

        th {
            background: var(--gray-50);
            font-weight: 600;
            color: var(--gray-700);
        }

        tr:hover {
            background: var(--gray-50);
        }

        .badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .badge-new {
            background: #d1fae5;
            color: #065f46;
        }

        .badge-modify {
            background: #dbeafe;
            color: #1e40af;
        }

        .file-tree {
            background: var(--gray-50);
            border-radius: 8px;
            padding: 1.5rem;
            font-family: 'Consolas', monospace;
            font-size: 0.9rem;
        }

        .file-tree .folder {
            color: var(--primary);
            font-weight: 600;
        }

        .file-tree .new {
            color: var(--success);
        }

        .highlight-box {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            border: 2px solid #f59e0b;
            border-radius: 12px;
            padding: 1.5rem;
            margin: 1rem 0;
        }

        .highlight-box h3 {
            color: #92400e;
            margin-bottom: 0.5rem;
        }

        .scheduler-demo {
            background: #1f2937;
            border-radius: 12px;
            padding: 1.5rem;
            color: white;
        }

        .scheduler-demo table {
            color: white;
        }

        .scheduler-demo th {
            background: #374151;
            color: #e5e7eb;
        }

        .scheduler-demo td {
            border-color: #4b5563;
        }

        .scheduler-demo code {
            background: #374151;
            color: #fbbf24;
        }

        .task-list {
            list-style: none;
            padding-left: 0;
        }

        .task-list li {
            padding: 0.5rem 0;
            padding-left: 2rem;
            position: relative;
        }

        .task-list li::before {
            content: "â˜";
            position: absolute;
            left: 0;
            color: var(--gray-600);
        }

        .task-list li.done::before {
            content: "â˜‘";
            color: var(--success);
        }

        .task-list li.in-progress::before {
            content: "â—";
            color: var(--warning);
        }

        /* Mermaid Diagram Styles */
        .mermaid {
            background: white;
            padding: 1rem;
            border-radius: 8px;
            margin: 1rem 0;
            text-align: center;
        }

        .diagram-container {
            overflow-x: auto;
            margin: 1rem 0;
        }

        footer {
            text-align: center;
            padding-top: 2rem;
            border-top: 1px solid var(--gray-200);
            color: var(--gray-600);
        }
    </style>
</head>

<body>
    <div class="container">
        <header>
            <h1>ğŸ“‹ ES_Schedule æ’ç¨‹ç³»çµ±å¯¦ä½œè¦åŠƒæ›¸</h1>
            <p class="subtitle">å¯æ“´å±•å¼å¤šæ’ç¨‹ä»»å‹™æ¶æ§‹ - Windows å·¥ä½œæ’ç¨‹å™¨æ•´åˆ</p>
        </header>

        <div class="meta-info">
            <div class="meta-item">
                <span class="label">ğŸ“… å»ºç«‹æ—¥æœŸ:</span>
                <span class="value">2026-01-15</span>
            </div>
            <div class="meta-item">
                <span class="label">ğŸ“¦ å°ˆæ¡ˆåç¨±:</span>
                <span class="value">ES_Schedule</span>
            </div>
            <div class="meta-item">
                <span class="label">ğŸ”§ ç›®æ¨™æ¡†æ¶:</span>
                <span class="value">.NET Framework 4.8</span>
            </div>
            <div class="meta-item">
                <span class="label">ğŸ“Š ç‹€æ…‹:</span>
                <span class="value">å¾…å¯©æ ¸ (v3)</span>
            </div>
        </div>

        <!-- ä»»å‹™å¿ƒæ™ºåœ– -->
        <section>
            <h2>ğŸ§  ä»»å‹™å¿ƒæ™ºåœ–</h2>
            <div class="card">
                <div class="diagram-container">
                    <pre class="mermaid">
mindmap
  root((ES_Schedule))
    Configuration
      App.config
        LogPath
        BatchSize
        ConnectionStrings
      TransferConfigs.json
    Core
      Logger
        MultiLevel
        ThreadSafe
      AppConfigService
        Singleton
    Jobs
      IScheduleJob
      JobFactory
      RepairTransferJob
    ErrorHandling
      ExitCode
        Success 0
        ParamError 1
        ConfigError 2
        Exception 3
    DataAccess
      OracleRepository
      MSSQLRepository
                    </pre>
                </div>
            </div>
        </section>

        <!-- ç³»çµ±æµç¨‹åœ– -->
        <section>
            <h2>ğŸ”„ ç³»çµ±æµç¨‹åœ–</h2>
            <div class="card">
                <h3>ä¸»ç¨‹å¼åŸ·è¡Œæµç¨‹</h3>
                <div class="diagram-container">
                    <div class="mermaid">
                        flowchart TD
                        A[ç¨‹å¼å•Ÿå‹•] --> B{æª¢æŸ¥å‘½ä»¤åˆ—å¼•æ•¸}
                        B -->|ç„¡å¼•æ•¸| C[è¨˜éŒ„å¯ç”¨ä»»å‹™æ¸…å–®]
                        C --> D[å›å‚³ Exit Code 1]
                        B -->|æœ‰å¼•æ•¸| E[å–å¾—ä»»å‹™åç¨±]
                        E --> F{JobFactory.CreateJob}
                        F -->|æ‰¾ä¸åˆ°ä»»å‹™| G[è¨˜éŒ„éŒ¯èª¤è¨Šæ¯]
                        G --> D
                        F -->|æ‰¾åˆ°ä»»å‹™| H[åŸ·è¡Œ job.ExecuteAsync]
                        H --> I{åŸ·è¡Œçµæœ}
                        I -->|æˆåŠŸ| J[å›å‚³ Exit Code 0]
                        I -->|å¤±æ•—| K[è¨˜éŒ„ä¾‹å¤–è¨Šæ¯]
                        K --> L[å›å‚³ Exit Code 3]

                        style A fill:#10b981,color:#fff
                        style J fill:#10b981,color:#fff
                        style D fill:#f59e0b,color:#fff
                        style L fill:#ef4444,color:#fff
                    </div>
                </div>
            </div>

            <div class="card">
                <h3>æ’ç¨‹ä»»å‹™åŸ·è¡Œæµç¨‹</h3>
                <div class="diagram-container">
                    <div class="mermaid">
                        flowchart TD
                        A[RepairRecordsTransferJob.ExecuteAsync] --> B[è¼‰å…¥é…ç½®æœå‹™]
                        B --> C{æª¢æŸ¥é€£ç·šå­—ä¸²}
                        C -->|ç„¡æ•ˆ| D[è¨˜éŒ„éŒ¯èª¤ä¸¦å›å‚³ 2]
                        C -->|æœ‰æ•ˆ| E[åˆå§‹åŒ– TransferService]
                        E --> F[ExecuteAllTransfersAsync]
                        F --> G[éæ­·å·²å•Ÿç”¨çš„è½‰ç§»é…ç½®]
                        G --> H[å¾ Oracle æŸ¥è©¢è³‡æ–™]
                        H --> I{æŸ¥è©¢çµæœ}
                        I -->|ç„¡è³‡æ–™| J[è¨˜éŒ„è­¦å‘Šä¸¦ç¹¼çºŒ]
                        I -->|æœ‰è³‡æ–™| K[æ‡‰ç”¨æ¬„ä½æ˜ å°„]
                        K --> L[å¯«å…¥ MSSQL]
                        L --> M[è¨˜éŒ„æˆåŠŸç­†æ•¸]
                        J --> N{é‚„æœ‰ä¸‹ä¸€å€‹é…ç½®?}
                        M --> N
                        N -->|æ˜¯| G
                        N -->|å¦| O[å›å‚³æˆåŠŸè¨ˆæ•¸]

                        style A fill:#2563eb,color:#fff
                        style O fill:#10b981,color:#fff
                        style D fill:#ef4444,color:#fff
                    </div>
                </div>
            </div>
        </section>

        <!-- è³‡æ–™æµç¨‹åœ– -->
        <section>
            <h2>ğŸ“Š è³‡æ–™æµç¨‹åœ–</h2>
            <div class="card">
                <h3>è³‡æ–™è½‰ç§»æµç¨‹</h3>
                <div class="diagram-container">
                    <div class="mermaid">
                        flowchart LR
                        subgraph ä¾†æº["ä¾†æºç³»çµ± (Oracle)"]
                        O1[(Oracle DB)]
                        O2[ç¶­ä¿®è¨˜éŒ„è¡¨]
                        end

                        subgraph è™•ç†["ES_Schedule è™•ç†"]
                        P1[OracleRepository]
                        P2[TransferService]
                        P3[æ¬„ä½æ˜ å°„]
                        P4[æ‰¹æ¬¡è™•ç†]
                        end

                        subgraph ç›®æ¨™["ç›®æ¨™ç³»çµ± (MSSQL)"]
                        M1[MSSQLRepository]
                        M2[(MSSQL DB)]
                        M3[ç›®æ¨™è³‡æ–™è¡¨]
                        end

                        subgraph æ—¥èªŒ["æ—¥èªŒç³»çµ±"]
                        L1[Logger]
                        L2[æ—¥èªŒæª”æ¡ˆ]
                        end

                        O1 --> O2
                        O2 -->|SourceQuery| P1
                        P1 -->|DynamicEntity| P2
                        P2 --> P3
                        P3 --> P4
                        P4 -->|BatchSize| M1
                        M1 --> M2
                        M2 --> M3

                        P1 -.->|è¨˜éŒ„æŸ¥è©¢| L1
                        P2 -.->|è¨˜éŒ„è™•ç†| L1
                        M1 -.->|è¨˜éŒ„å¯«å…¥| L1
                        L1 --> L2

                        style O1 fill:#f59e0b,color:#fff
                        style M2 fill:#2563eb,color:#fff
                        style L2 fill:#10b981,color:#fff
                    </div>
                </div>
            </div>

            <div class="card">
                <h3>é…ç½®è¼‰å…¥æµç¨‹</h3>
                <div class="diagram-container">
                    <div class="mermaid">
                        flowchart TD
                        subgraph é…ç½®æª”æ¡ˆ
                        A1[App.config]
                        A2[TransferConfigs.json]
                        end

                        subgraph AppConfigService
                        B1[LoadConnectionStrings]
                        B2[LoadAppSettings]
                        B3[LoadTransferConfigs]
                        end

                        subgraph é…ç½®å±¬æ€§
                        C1[SourceConnectionString]
                        C2[DestinationConnectionString]
                        C3[LogPath]
                        C4[BatchSize]
                        C5["TransferConfigs[]"]
                        end

                        A1 -->|connectionStrings| B1
                        A1 -->|appSettings| B2
                        A2 -->|JSON| B3

                        B1 --> C1
                        B1 --> C2
                        B2 --> C3
                        B2 --> C4
                        B3 --> C5

                        style A1 fill:#374151,color:#fff
                        style A2 fill:#374151,color:#fff
                    </div>
                </div>
            </div>
        </section>

        <!-- ä»»å‹™æ¸…å–® -->
        <section>
            <h2>ğŸ“ ä»»å‹™æ¸…å–®</h2>

            <div class="card">
                <h3>éšæ®µä¸€ï¼šè¦åŠƒèˆ‡è¨­è¨ˆ</h3>
                <ul class="task-list">
                    <li class="done">è®€å–ç¾æœ‰æ–‡ä»¶èˆ‡ç¨‹å¼ç¢¼</li>
                    <li class="done">åˆ†æç¾æœ‰ Console.WriteLine ä½¿ç”¨æƒ…æ³</li>
                    <li class="done">å»ºç«‹æ›´æ–°ç‰ˆçš„å¯¦ä½œè¦åŠƒæ›¸</li>
                    <li>é€šçŸ¥ä½¿ç”¨è€…å¯©æ ¸è¦åŠƒæ›¸</li>
                </ul>
            </div>

            <div class="card">
                <h3>éšæ®µäºŒï¼šé…ç½®è¨­å®š</h3>
                <ul class="task-list">
                    <li>æ›´æ–° App.config æ–°å¢ LogPath è¨­å®š</li>
                    <li>æ›´æ–° App.config æ–°å¢å…¶ä»–ç›¸é—œè¨­å®š (BatchSize ç­‰)</li>
                </ul>
            </div>

            <div class="card">
                <h3>éšæ®µä¸‰ï¼šæ ¸å¿ƒå…ƒä»¶å¯¦ä½œ</h3>
                <ul class="task-list">
                    <li>å»ºç«‹ Common/Logger.cs - æ—¥èªŒæœå‹™é¡åˆ¥</li>
                    <li>å»ºç«‹ Config/AppConfigService.cs - é…ç½®æœå‹™é¡åˆ¥</li>
                    <li>å»ºç«‹ Config/TransferConfig.cs - è½‰ç§»é…ç½®æ¨¡å‹</li>
                </ul>
            </div>

            <div class="card">
                <h3>éšæ®µå››ï¼šéŒ¯èª¤è™•ç†æ©Ÿåˆ¶</h3>
                <ul class="task-list">
                    <li>åœ¨ Logger ä¸­åŠ å…¥å®Œæ•´çš„ä¾‹å¤–è™•ç†æ–¹æ³•</li>
                    <li>ç¢ºä¿æ‰€æœ‰ Log æ–¹æ³•åŒ…å« try-catch</li>
                    <li>ä¸»ç¨‹å¼åŠ å…¥ Exit Code å›å‚³æ©Ÿåˆ¶</li>
                </ul>
            </div>

            <div class="card">
                <h3>éšæ®µäº”ï¼šæ›´æ–°è¦åŠƒæ›¸</h3>
                <ul class="task-list">
                    <li class="done">æ›´æ–° Implementation_Plan.html æ–°å¢ Log ç›¸é—œç« ç¯€</li>
                    <li class="done">æ–°å¢éŒ¯èª¤è™•ç†æ©Ÿåˆ¶èªªæ˜</li>
                    <li class="done">æ–°å¢ LogPath é…ç½®èªªæ˜</li>
                    <li class="done">æ–°å¢ç³»çµ±æµç¨‹åœ–</li>
                    <li class="done">æ–°å¢è³‡æ–™æµç¨‹åœ–</li>
                    <li class="done">æ–°å¢ä»»å‹™å¿ƒæ™ºåœ–</li>
                </ul>
            </div>

            <div class="card">
                <h3>éšæ®µå…­ï¼šé©—è­‰</h3>
                <ul class="task-list">
                    <li>ç·¨è­¯å°ˆæ¡ˆç¢ºèªç„¡éŒ¯èª¤</li>
                    <li>åŸ·è¡Œæ¸¬è©¦ç¢ºèª Log æ­£å¸¸å¯«å…¥</li>
                </ul>
            </div>
        </section>

        <!-- ç¾æ³åˆ†æ -->
        <section>
            <h2>ğŸ” ç¾æ³åˆ†æï¼šConsole.WriteLine ä½¿ç”¨ä½ç½®</h2>

            <div class="card">
                <table>
                    <thead>
                        <tr>
                            <th>æª”æ¡ˆ</th>
                            <th>è¡Œè™Ÿ</th>
                            <th>ç”¨é€”</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>Program.cs</code></td>
                            <td>29-31, 41, 55, 59, 65, 75, 84-86, 91, 94, 100, 108, 113, 121-123</td>
                            <td>ç¨‹å¼å•Ÿå‹•ã€é…ç½®æª”ã€åŸ·è¡Œé€²åº¦</td>
                        </tr>
                        <tr>
                            <td><code>Logger.cs</code></td>
                            <td>187, 200</td>
                            <td>Log æ–¹æ³•æœ¬èº«ä½¿ç”¨ Console è¼¸å‡º</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="alert alert-danger">
                <span>âš ï¸</span>
                <div>
                    <strong>é‡è¦ä¿®æ”¹ï¼š</strong>
                    <p>ä½œç‚º Windows å·¥ä½œæ’ç¨‹å™¨çš„æ’ç¨‹ä»»å‹™ï¼Œç¨‹å¼ä¸æ‡‰è©²æœ‰ä»»ä½• Console è¼¸å‡ºã€‚æ‰€æœ‰è¨Šæ¯éƒ½æ‡‰å¯«å…¥æ—¥èªŒæª”æ¡ˆã€‚</p>
                </div>
            </div>
        </section>

        <!-- æ—¥èªŒæ©Ÿåˆ¶ -->
        <section>
            <h2>ğŸ“ æ—¥èªŒæ©Ÿåˆ¶è¨­è¨ˆ</h2>

            <h3>LogPath é…ç½®èªªæ˜</h3>
            <div class="card">
                <p>åœ¨ <code>App.config</code> ä¸­è¨­å®šæ—¥èªŒè·¯å¾‘ï¼š</p>
                <pre><code>&lt;appSettings&gt;
  &lt;add key="LogPath" value="Logs" /&gt;
  &lt;add key="BatchSize" value="1000" /&gt;
&lt;/appSettings&gt;</code></pre>
                <ul>
                    <li><strong>LogPath</strong>: æ—¥èªŒæª”æ¡ˆå„²å­˜ç›®éŒ„ï¼Œå¯ä½¿ç”¨ç›¸å°æˆ–çµ•å°è·¯å¾‘</li>
                    <li><strong>BatchSize</strong>: è³‡æ–™è½‰ç§»æ‰¹æ¬¡å¤§å°ï¼Œé è¨­ 1000 ç­†</li>
                </ul>
            </div>

            <h3>Logger é¡åˆ¥è¨­è¨ˆ</h3>
            <div class="card">
                <ul>
                    <li>ä½¿ç”¨ <strong>Singleton æ¨¡å¼</strong> (<code>Lazy&lt;Logger&gt;</code>)</li>
                    <li>æ”¯æ´å¤šç´šåˆ¥æ—¥èªŒ: <code>Debug</code>, <code>Info</code>, <code>Warning</code>, <code>Error</code>,
                        <code>Fatal</code>
                    </li>
                    <li>ä½¿ç”¨ <strong>Thread-Safe é–</strong> é€²è¡Œæª”æ¡ˆå¯«å…¥</li>
                    <li>æ—¥èªŒæª”æ¡ˆå‘½åæ ¼å¼ï¼š<code>{yyyy-MM-dd}.log</code></li>
                    <li><strong>ç§»é™¤ Console.WriteLine</strong> - åƒ…å¯«å…¥æ—¥èªŒæª”æ¡ˆ</li>
                </ul>

                <h4>æ—¥èªŒæ ¼å¼ç¯„ä¾‹</h4>
                <pre><code>[2026-01-15 14:30:25.123] [Info   ] [Thread-1] ç¨‹å¼å•Ÿå‹•ï¼Œæ­£åœ¨è¼‰å…¥è¨­å®š...
[2026-01-15 14:30:25.456] [Info   ] [Thread-1] é…ç½®æœå‹™åˆå§‹åŒ–å®Œæˆ
[2026-01-15 14:30:26.789] [Error  ] [Thread-1] è³‡æ–™åº«é€£ç·šå¤±æ•—
ä¾‹å¤–é¡å‹: OracleException
ä¾‹å¤–è¨Šæ¯: ORA-12154: TNS:ç„¡æ³•è§£ææŒ‡å®šçš„é€£ç·šè­˜åˆ¥ç¢¼</code></pre>
            </div>
        </section>

        <!-- éŒ¯èª¤è™•ç†æ©Ÿåˆ¶ -->
        <section>
            <h2>ğŸ›¡ï¸ éŒ¯èª¤è™•ç†æ©Ÿåˆ¶</h2>

            <h3>Exit Code è¦ç¯„</h3>
            <div class="card">
                <table>
                    <thead>
                        <tr>
                            <th>Exit Code</th>
                            <th>æ„ç¾©</th>
                            <th>èªªæ˜</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>0</code></td>
                            <td>âœ… æˆåŠŸåŸ·è¡Œ</td>
                            <td>æ’ç¨‹ä»»å‹™æ­£å¸¸å®Œæˆ</td>
                        </tr>
                        <tr>
                            <td><code>1</code></td>
                            <td>âš ï¸ åƒæ•¸éŒ¯èª¤</td>
                            <td>æœªæŒ‡å®šä»»å‹™åç¨±æˆ–æ‰¾ä¸åˆ°æŒ‡å®šä»»å‹™</td>
                        </tr>
                        <tr>
                            <td><code>2</code></td>
                            <td>âš ï¸ é…ç½®éŒ¯èª¤</td>
                            <td>é€£ç·šå­—ä¸²ç¼ºå¤±æˆ–é…ç½®æª”ç„¡æ•ˆ</td>
                        </tr>
                        <tr>
                            <td><code>3</code></td>
                            <td>âŒ åŸ·è¡Œä¾‹å¤–</td>
                            <td>åŸ·è¡Œéç¨‹ä¸­ç™¼ç”Ÿæœªè™•ç†çš„ä¾‹å¤–</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <h3>ä¸»ç¨‹å¼æµç¨‹</h3>
            <div class="card">
                <pre><code>static async Task&lt;int&gt; Main(string[] args)
{
    try
    {
        Logger.Instance.Info($"ç¨‹å¼å•Ÿå‹•æ™‚é–“: {DateTime.Now}");
        
        string jobName = args.Length &gt; 0 ? args[0] : null;
        
        if (string.IsNullOrEmpty(jobName))
        {
            Logger.Instance.Info("æœªæŒ‡å®šä»»å‹™åç¨±ï¼Œé¡¯ç¤ºå¯ç”¨ä»»å‹™æ¸…å–®");
            foreach (var job in JobFactory.GetAvailableJobs())
            {
                Logger.Instance.Info($"  - {job}");
            }
            return 1;
        }
        
        var job = JobFactory.CreateJob(jobName);
        if (job == null)
        {
            Logger.Instance.Error($"æ‰¾ä¸åˆ°æ’ç¨‹ä»»å‹™: {jobName}");
            return 1;
        }
        
        return await job.ExecuteAsync();
    }
    catch (Exception ex)
    {
        Logger.Instance.Exception(ex, "ç¨‹å¼åŸ·è¡Œéç¨‹ä¸­ç™¼ç”Ÿæœªè™•ç†çš„ä¾‹å¤–");
        return 3;
    }
}</code></pre>
            </div>
        </section>

        <!-- æ ¸å¿ƒé‡é»ï¼šWindows å·¥ä½œæ’ç¨‹å™¨æ•´åˆ -->
        <section>
            <h2>ğŸ¯ æ ¸å¿ƒè¨­è¨ˆï¼šWindows å·¥ä½œæ’ç¨‹å™¨æ•´åˆ</h2>

            <div class="highlight-box">
                <h3>â­ ä½¿ç”¨æ–¹å¼èªªæ˜</h3>
                <p>ç·¨è­¯å¾Œçš„ <code>ES_Schedule.exe</code> å¯åœ¨ Windows å·¥ä½œæ’ç¨‹å™¨ä¸­è¨­å®šï¼Œé€éã€Œ<strong>æ–°å¢å¼•æ•¸
                        (å¯çœç•¥)(A):</strong>ã€æ¬„ä½å‚³å…¥åƒæ•¸ä¾†æŒ‡å®šè¦åŸ·è¡Œçš„æ’ç¨‹ä»»å‹™ã€‚</p>
            </div>

            <h3>å·¥ä½œæ’ç¨‹å™¨è¨­å®šç¯„ä¾‹</h3>
            <div class="scheduler-demo">
                <table>
                    <thead>
                        <tr>
                            <th>æ¬„ä½</th>
                            <th>è¨­å®šå€¼</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>ç¨‹å¼æˆ–æŒ‡ä»¤ç¢¼ (P):</strong></td>
                            <td><code>D:\Path\To\ES_Schedule.exe</code></td>
                        </tr>
                        <tr>
                            <td><strong>æ–°å¢å¼•æ•¸ (å¯çœç•¥)(A):</strong></td>
                            <td><code>RepairRecordsTransfer</code></td>
                        </tr>
                        <tr>
                            <td><strong>é–‹å§‹ä½ç½® (å¯çœç•¥)(T):</strong></td>
                            <td><code>D:\Path\To\</code></td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="alert alert-info">
                <span>ğŸ’¡</span>
                <div>
                    <strong>é‹ä½œåŸç†ï¼š</strong>
                    <p>ç¨‹å¼é€é <code>args[0]</code> ç›´æ¥è®€å–ã€Œæ–°å¢å¼•æ•¸ã€æ¬„ä½çš„å€¼ï¼Œè‡ªå‹•åˆ¤æ–·è¦åŸ·è¡Œå“ªä¸€å€‹æ’ç¨‹ä»»å‹™ã€‚ä¸éœ€è¦ä½¿ç”¨ <code>--job=</code>
                        ç­‰è¤‡é›œæ ¼å¼ï¼Œ<strong>åªéœ€è¼¸å…¥ä»»å‹™åç¨±å³å¯</strong>ã€‚</p>
                </div>
            </div>

            <h3>å¤šæ’ç¨‹ä»»å‹™éƒ¨ç½²ç¯„ä¾‹</h3>
            <div class="card">
                <table>
                    <thead>
                        <tr>
                            <th>æ’ç¨‹åç¨±</th>
                            <th>ç¨‹å¼è·¯å¾‘</th>
                            <th>å¼•æ•¸</th>
                            <th>åŸ·è¡Œæ™‚é–“</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>ç¶­ä¿®è¨˜éŒ„è½‰ç§»</td>
                            <td><code>ES_Schedule.exe</code></td>
                            <td><code>RepairRecordsTransfer</code></td>
                            <td>æ¯æ—¥ 02:00</td>
                        </tr>
                        <tr>
                            <td>æ¯æ—¥å ±è¡¨</td>
                            <td><code>ES_Schedule.exe</code></td>
                            <td><code>DailyReport</code></td>
                            <td>æ¯æ—¥ 08:00</td>
                        </tr>
                        <tr>
                            <td>è³‡æ–™æ¸…ç†</td>
                            <td><code>ES_Schedule.exe</code></td>
                            <td><code>DataCleanup</code></td>
                            <td>æ¯é€±æ—¥ 03:00</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- ç›®éŒ„çµæ§‹ -->
        <section>
            <h2>ğŸ“ å°ˆæ¡ˆç›®éŒ„çµæ§‹</h2>
            <div class="file-tree">
                <pre>ES_Schedule/
â”œâ”€â”€ <span class="folder">Common/</span>
â”‚   â””â”€â”€ <span class="new">[NEW] Logger.cs</span>              # æ—¥èªŒæœå‹™ï¼ˆç„¡ Console è¼¸å‡ºï¼‰
â”‚
â”œâ”€â”€ <span class="folder">Config/</span>
â”‚   â”œâ”€â”€ <span class="new">[NEW] AppConfigService.cs</span>    # é…ç½®æœå‹™
â”‚   â””â”€â”€ <span class="new">[NEW] TransferConfig.cs</span>      # è½‰ç§»é…ç½®æ¨¡å‹
â”‚
â”œâ”€â”€ <span class="folder">Entities/</span>
â”‚   â””â”€â”€ <span class="new">[NEW] DynamicEntity.cs</span>       # å‹•æ…‹å¯¦é«”é¡
â”‚
â”œâ”€â”€ <span class="folder">Interfaces/</span>
â”‚   â”œâ”€â”€ <span class="new">[NEW] IScheduleJob.cs</span>        # æ’ç¨‹ä»»å‹™ä»‹é¢ â­
â”‚   â””â”€â”€ <span class="new">[NEW] IRepository.cs</span>         # è³‡æ–™å­˜å–ä»‹é¢
â”‚
â”œâ”€â”€ <span class="folder">Repositories/</span>
â”‚   â”œâ”€â”€ <span class="new">[NEW] OracleRepository.cs</span>
â”‚   â””â”€â”€ <span class="new">[NEW] MSSQLRepository.cs</span>
â”‚
â”œâ”€â”€ <span class="folder">Jobs/</span>                            # æ’ç¨‹ä»»å‹™å¯¦ä½œ â­
â”‚   â””â”€â”€ <span class="new">[NEW] RepairRecordsTransferJob.cs</span>
â”‚
â”œâ”€â”€ <span class="folder">Services/</span>
â”‚   â”œâ”€â”€ <span class="new">[NEW] JobFactory.cs</span>          # ä»»å‹™å·¥å»  â­
â”‚   â””â”€â”€ <span class="new">[NEW] TransferService.cs</span>
â”‚
â”œâ”€â”€ <span class="folder">Settings/</span>
â”‚   â””â”€â”€ <span class="new">[NEW] TransferConfigs.json</span>
â”‚
â”œâ”€â”€ Program.cs                       # ä¸»ç¨‹å¼ (é‡å¯«)
â”œâ”€â”€ App.config                       # é…ç½®æª” (æ›´æ–°)
â””â”€â”€ ES_Schedule.csproj               # å°ˆæ¡ˆæª” (æ›´æ–°)</pre>
            </div>
        </section>

        <!-- æ ¸å¿ƒä»‹é¢ -->
        <section>
            <h2>ğŸ”Œ æ ¸å¿ƒä»‹é¢è¨­è¨ˆ</h2>

            <h3>IScheduleJob ä»‹é¢</h3>
            <div class="card">
                <pre><code>/// &lt;summary&gt;
/// æ’ç¨‹ä»»å‹™ä»‹é¢ - æ‰€æœ‰æ’ç¨‹ä»»å‹™å¿…é ˆå¯¦ä½œ
/// &lt;/summary&gt;
public interface IScheduleJob
{
    /// &lt;summary&gt;
    /// ä»»å‹™è­˜åˆ¥åç¨± (å°æ‡‰å·¥ä½œæ’ç¨‹å™¨çš„å¼•æ•¸)
    /// &lt;/summary&gt;
    string JobName { get; }
    
    /// &lt;summary&gt;
    /// ä»»å‹™æè¿°
    /// &lt;/summary&gt;
    string Description { get; }
    
    /// &lt;summary&gt;
    /// åŸ·è¡Œæ’ç¨‹ä»»å‹™
    /// &lt;/summary&gt;
    /// &lt;returns&gt;0=æˆåŠŸ, é0=å¤±æ•—&lt;/returns&gt;
    Task&lt;int&gt; ExecuteAsync();
}</code></pre>
            </div>

            <h3>JobFactory ä»»å‹™å·¥å» </h3>
            <div class="card">
                <pre><code>public static class JobFactory
{
    // å·²è¨»å†Šçš„æ’ç¨‹ä»»å‹™
    private static readonly Dictionary&lt;string, Func&lt;IScheduleJob&gt;&gt; _jobs 
        = new Dictionary&lt;string, Func&lt;IScheduleJob&gt;&gt;(StringComparer.OrdinalIgnoreCase)
    {
        { "RepairRecordsTransfer", () =&gt; new RepairRecordsTransferJob() },
        // æœªä¾†æ–°å¢å…¶ä»–ä»»å‹™åªéœ€åœ¨æ­¤è¨»å†Š
        // { "DailyReport", () =&gt; new DailyReportJob() },
    };
    
    public static IScheduleJob CreateJob(string jobName)
    {
        if (_jobs.TryGetValue(jobName, out var factory))
            return factory();
        return null;
    }
    
    public static IEnumerable&lt;string&gt; GetAvailableJobs() =&gt; _jobs.Keys;
}</code></pre>
            </div>
        </section>

        <!-- å¯¦ä½œè¨ˆç•« -->
        <section>
            <h2>ğŸ“ å¯¦ä½œè¨ˆç•«</h2>

            <div class="card">
                <table>
                    <thead>
                        <tr>
                            <th>Phase</th>
                            <th>å…§å®¹</th>
                            <th>æª”æ¡ˆæ•¸</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Phase 1</strong></td>
                            <td>æ ¸å¿ƒä»‹é¢ (IScheduleJob, JobFactory)</td>
                            <td>3 å€‹</td>
                        </tr>
                        <tr>
                            <td><strong>Phase 2</strong></td>
                            <td>å…±ç”¨å…ƒä»¶é·ç§» (Logger, Config, Entity)</td>
                            <td>4 å€‹</td>
                        </tr>
                        <tr>
                            <td><strong>Phase 3</strong></td>
                            <td>è³‡æ–™å­˜å–å±¤ (Oracle, MSSQL Repository)</td>
                            <td>3 å€‹</td>
                        </tr>
                        <tr>
                            <td><strong>Phase 4</strong></td>
                            <td>æ¥­å‹™é‚è¼¯ (TransferService, Job)</td>
                            <td>2 å€‹</td>
                        </tr>
                        <tr>
                            <td><strong>Phase 5</strong></td>
                            <td>ä¸»ç¨‹å¼èˆ‡é…ç½®æ›´æ–°</td>
                            <td>4 å€‹</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- é©—è­‰è¨ˆç•« -->
        <section>
            <h2>âœ… é©—è­‰è¨ˆç•«</h2>
            <div class="card">
                <table>
                    <thead>
                        <tr>
                            <th>æ¸¬è©¦é …ç›®</th>
                            <th>å¼•æ•¸</th>
                            <th>é æœŸçµæœ</th>
                            <th>Exit Code</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>ç„¡å¼•æ•¸åŸ·è¡Œ</td>
                            <td>(ç©º)</td>
                            <td>è¨˜éŒ„å¯ç”¨ä»»å‹™æ¸…å–®è‡³ Log</td>
                            <td>1</td>
                        </tr>
                        <tr>
                            <td>åŸ·è¡Œè½‰ç§»ä»»å‹™</td>
                            <td><code>RepairRecordsTransfer</code></td>
                            <td>æˆåŠŸåŸ·è¡Œè³‡æ–™è½‰ç§»</td>
                            <td>0</td>
                        </tr>
                        <tr>
                            <td>ç„¡æ•ˆä»»å‹™åç¨±</td>
                            <td><code>InvalidJob</code></td>
                            <td>è¨˜éŒ„éŒ¯èª¤è¨Šæ¯è‡³ Log</td>
                            <td>1</td>
                        </tr>
                        <tr>
                            <td>æª¢æŸ¥æ—¥èªŒæª”æ¡ˆ</td>
                            <td>-</td>
                            <td>Logs/{yyyy-MM-dd}.log å»ºç«‹æˆåŠŸ</td>
                            <td>-</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <h3>é©—è­‰å‘½ä»¤</h3>
            <div class="card">
                <pre><code># ç·¨è­¯å°ˆæ¡ˆ
msbuild ES_Schedule.sln /t:Rebuild /p:Configuration=Debug

# ç„¡åƒæ•¸åŸ·è¡Œæ¸¬è©¦
.\bin\Debug\ES_Schedule.exe
$LASTEXITCODE  # é æœŸ: 1

# ç„¡æ•ˆä»»å‹™æ¸¬è©¦
.\bin\Debug\ES_Schedule.exe InvalidJob
$LASTEXITCODE  # é æœŸ: 1

# æª¢æŸ¥æ—¥èªŒæª”æ¡ˆ
Get-Content ".\bin\Debug\Logs\$(Get-Date -Format 'yyyy-MM-dd').log"</code></pre>
            </div>
        </section>

        <!-- æ“´å±•æŒ‡å— -->
        <section>
            <h2>ğŸš€ æ–°å¢æ’ç¨‹ä»»å‹™æ­¥é©Ÿ</h2>
            <div class="card">
                <ol>
                    <li>åœ¨ <code>Jobs/</code> å»ºç«‹æ–°é¡åˆ¥ï¼Œå¯¦ä½œ <code>IScheduleJob</code></li>
                    <li>åœ¨ <code>JobFactory._jobs</code> ä¸­è¨»å†Šä»»å‹™åç¨±</li>
                    <li>ç·¨è­¯å°ˆæ¡ˆ</li>
                    <li>åœ¨ Windows å·¥ä½œæ’ç¨‹å™¨æ–°å¢æ’ç¨‹ï¼Œå¼•æ•¸å¡«å…¥ä»»å‹™åç¨±</li>
                </ol>
            </div>
        </section>

        <!-- è¦ç¯„ç¬¦åˆæ€§æª¢æŸ¥ -->
        <section>
            <h2>ğŸ“‹ è¦ç¯„ç¬¦åˆæ€§æª¢æŸ¥</h2>
            <div class="card">
                <table>
                    <thead>
                        <tr>
                            <th>è¦ç¯„é …ç›®</th>
                            <th>ç‹€æ…‹</th>
                            <th>èªªæ˜</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>HTML æ ¼å¼æ–‡ä»¶</td>
                            <td>âœ… ç¬¦åˆ</td>
                            <td>ä½¿ç”¨ç¨ç«‹ HTML æª”æ¡ˆ (.html)</td>
                        </tr>
                        <tr>
                            <td>Vue.js 3 CDN</td>
                            <td>âœ… ç¬¦åˆ</td>
                            <td>å·²åœ¨ &lt;head&gt; ä¸­å¼•å…¥</td>
                        </tr>
                        <tr>
                            <td>SweetAlert2 CDN</td>
                            <td>âœ… ç¬¦åˆ</td>
                            <td>å·²åœ¨ &lt;head&gt; ä¸­å¼•å…¥</td>
                        </tr>
                        <tr>
                            <td>Google Chart / Mermaid</td>
                            <td>âœ… ç¬¦åˆ</td>
                            <td>ä½¿ç”¨ Mermaid.js ç¹ªè£½æµç¨‹åœ–</td>
                        </tr>
                        <tr>
                            <td>ç³»çµ±æµç¨‹åœ–</td>
                            <td>âœ… ç¬¦åˆ</td>
                            <td>ä¸»ç¨‹å¼æµç¨‹ã€æ’ç¨‹ä»»å‹™åŸ·è¡Œæµç¨‹</td>
                        </tr>
                        <tr>
                            <td>è³‡æ–™æµç¨‹åœ–</td>
                            <td>âœ… ç¬¦åˆ</td>
                            <td>è³‡æ–™è½‰ç§»æµç¨‹ã€é…ç½®è¼‰å…¥æµç¨‹</td>
                        </tr>
                        <tr>
                            <td>ä»»å‹™å¿ƒæ™ºåœ–</td>
                            <td>âœ… ç¬¦åˆ</td>
                            <td>ES_Schedule åŠŸèƒ½æ¶æ§‹å¿ƒæ™ºåœ–</td>
                        </tr>
                        <tr>
                            <td>.NET Framework 4.8</td>
                            <td>âœ… ç¬¦åˆ</td>
                            <td>éµå¾ªç¾æœ‰å°ˆæ¡ˆæ¡†æ¶ç‰ˆæœ¬</td>
                        </tr>
                        <tr>
                            <td>æ–‡ä»¶å­˜æ”¾ä½ç½®</td>
                            <td>âœ… ç¬¦åˆ</td>
                            <td>å­˜æ”¾æ–¼ #æ–‡ä»¶ ç›®éŒ„</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <footer>
            <p>ğŸ“„ ES_Schedule Implementation Plan v3 | 2026-01-15 | ç¬¦åˆ Customization Rules è¦ç¯„</p>
        </footer>
    </div>

    <script>
        // Initialize Mermaid
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default',
            flowchart: {
                useMaxWidth: true,
                htmlLabels: true,
                curve: 'basis'
            },
            mindmap: {
                useMaxWidth: true
            }
        });
    </script>
</body>

</html>